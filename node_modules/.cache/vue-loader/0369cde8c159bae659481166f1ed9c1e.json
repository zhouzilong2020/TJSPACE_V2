{"remainingRequest":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhouzilong/Desktop/2020-09-19-0005/src/components/userInfo/login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/src/components/userInfo/login.vue","mtime":1605872531897},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/vue-cli-plugin-quasar/lib/loader.auto-import.js","mtime":499162500000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGltcG9ydCBwb3BEaWFsb2cgZnJvbSAiLi4vcG9wRGlhbG9nIjsKaW1wb3J0IHsgbWFwU3RhdGUgfSBmcm9tICJ2dWV4IjsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIC8vIHBvcERpYWxvZywKICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNQd2Q6IHRydWUsCiAgICAgIHJlbWVtYmVyOiBmYWxzZSwKICAgICAgYWNjb3VudDogewogICAgICAgIGVtYWlsOiAiIiwKICAgICAgICBwYXNzd29yZDogIiIsCiAgICAgIH0sCiAgICAgIHdhcm5pbmc6IGZhbHNlLAogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoInVzZXJJbmZvIiwgWyJpc0xvYWRpbmciLCAidG9rZW4iLCAidXNlckluZm8iXSksCiAgICBpc0Rpc2FibGVkKCkgewogICAgICBpZiAodGhpcy5hY2NvdW50LmVtYWlsICYmIHRoaXMuYWNjb3VudC5wYXNzd29yZCkgcmV0dXJuIGZhbHNlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIGlmICh0aGlzLnVzZXJJbmZvKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAiSG9tZXBhZ2UiLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgdXNlcklkOiB0aGlzLnVzZXJJbmZvLnVzZXJpZCwKICAgICAgICB9LAogICAgICB9KTsKICAgIH0KICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiVEpTUEFDRS1lbWFpbCIpKSB7CiAgICAgIHRoaXMuYWNjb3VudC5lbWFpbCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJUSlNQQUNFLWVtYWlsIik7CiAgICAgIHRoaXMucmVtZW1iZXIgPSB0cnVlOwogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGhhbmRsZUxvZ2luKCkgewogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgidXNlckluZm8vbG9naW5Vc2VyIiwgewogICAgICAgIGFjY291bnQ6IHRoaXMuYWNjb3VudCwKICAgICAgICByZW1lbWJlcjogdGhpcy5yZW1lbWJlciwKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLnRva2VuKSB7CiAgICAgICAgLy8g5oiQ5Yqf6I635Y+WdG9rZW4g6KGo56S65oiQ5Yqf55m75b2VCiAgICAgICAgLy8gY29uc29sZS5sb2coImdldCB1c2VyIHRva2VuIikKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJpbiBsb2dpbiBwYWdlIiwgdGhpcy51c2VySW5mbyk7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICJIb21lcGFnZSIsCiAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgIHVzZXJJZDogdGhpcy51c2VySW5mby51c2VyaWQsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KTsKICAgICAgICB9LCAyMDAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvL+WvhueggemUmeivrwogICAgICAgIGNvbnNvbGUubG9nKCLlr4bnoIHplJnor68iKTsKICAgICAgICB0aGlzLiRxLm5vdGlmeSh7CiAgICAgICAgICAgIG1lc3NhZ2U6ICLlr4bnoIHplJnor68iLAogICAgICAgICAgICBwb3NpdGlvbjogImNlbnRlciIsCiAgICAgICAgICAgIHRpbWVvdXQ6ICIyMDAwIiwKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+DA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src/components/userInfo","sourcesContent":["<template>\n  <q-card class=\"q-my-md bg-grey-2 my-card col-md-4 col-xs-12\">\n    <q-card-section>\n      <div class=\"title\">\n        <h5>欢迎使用</h5>\n        <h5 class=\"title-name\">TJSPACE· 同济大学社群</h5>\n      </div>\n      <q-form class=\"q-gutter-md\">\n        <q-input\n          class=\"email\"\n          clearable\n          clear-icon=\"close\"\n          v-model=\"account.email\"\n          label=\"邮箱:\"\n          suffix=\"@tongji.edu.cn\"\n          hint=\"请输入注册时使用的同济邮箱\"\n        />\n\n        <q-input\n          v-model=\"account.password\"\n          label=\"密码:\"\n          :type=\"isPwd ? 'password' : 'text'\"\n        >\n          <template v-slot:append>\n            <q-icon\n              :name=\"isPwd ? 'visibility_off' : 'visibility'\"\n              class=\"cursor-pointer\"\n              @click=\"isPwd = !isPwd\"\n            />\n          </template>\n        </q-input>\n\n        <q-toggle v-model=\"remember\" label=\"记住邮箱\" />\n\n        <div>\n          <q-btn\n            :loading=\"isLoading\"\n            :disable=\"isDisabled\"\n            class=\"queren-btn\"\n            label=\"登录\"\n            color=\"primary\"\n            @click=\"handleLogin()\"\n          >\n          </q-btn>\n        </div>\n        <q-btn-group flat spread>\n          <q-btn flat color=\"primary\" label=\"忘记密码\" />\n          <q-btn\n            flat\n            color=\"primary\"\n            :to=\"{ name: 'register' }\"\n            label=\"现在注册\"\n          />\n        </q-btn-group>\n      </q-form>\n    </q-card-section>\n\n    \n  </q-card>\n  \n</template>\n\n<script>\n// import popDialog from \"../popDialog\";\nimport { mapState } from \"vuex\";\nexport default {\n  components: {\n    // popDialog,\n  },\n\n  data() {\n    return {\n      isPwd: true,\n      remember: false,\n      account: {\n        email: \"\",\n        password: \"\",\n      },\n      warning: false,\n    };\n  },\n\n  computed: {\n    ...mapState(\"userInfo\", [\"isLoading\", \"token\", \"userInfo\"]),\n    isDisabled() {\n      if (this.account.email && this.account.password) return false;\n      return true;\n    },\n  },\n\n  created() {\n    if (this.userInfo) {\n      this.$router.push({\n        name: \"Homepage\",\n        params: {\n          userId: this.userInfo.userid,\n        },\n      });\n    }\n    if (localStorage.getItem(\"TJSPACE-email\")) {\n      this.account.email = localStorage.getItem(\"TJSPACE-email\");\n      this.remember = true;\n    }\n  },\n\n  methods: {\n    async handleLogin() {\n      await this.$store.dispatch(\"userInfo/loginUser\", {\n        account: this.account,\n        remember: this.remember,\n      });\n      if (this.token) {\n        // 成功获取token 表示成功登录\n        // console.log(\"get user token\")\n        setTimeout(() => {\n          console.log(\"in login page\", this.userInfo);\n          this.$router.push({\n            name: \"Homepage\",\n            params: {\n              userId: this.userInfo.userid,\n            },\n          });\n        }, 2000);\n      } else {\n        //密码错误\n        console.log(\"密码错误\");\n        this.$q.notify({\n            message: \"密码错误\",\n            position: \"center\",\n            timeout: \"2000\",\n          });\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.my-card {\n  max-width: 350px;\n}\n.title {\n  text-align: center;\n}\n\n.title-name {\n  font-weight: bold;\n  font-size: 27px;\n  line-height: -2;\n}\n\n.queren-btn {\n  width: 100%;\n}\n</style>\n"]}]}