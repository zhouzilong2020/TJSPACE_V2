{"remainingRequest":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhouzilong/Desktop/2020-09-19-0005/src/components/makeComment/makeComment.vue?vue&type=style&index=0&id=94df169a&scoped=true&lang=css&","dependencies":[{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/src/components/makeComment/makeComment.vue","mtime":1600440979000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/vue-cli-plugin-quasar/lib/loader.auto-import.js","mtime":499162500000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhouzilong/Desktop/2020-09-19-0005/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmNvbW1lbnRDYXJkIHsKICBtYXgtd2lkdGg6IDgwMHB4Owp9Cg=="},{"version":3,"sources":["makeComment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8iBA;AACA;AACA","file":"makeComment.vue","sourceRoot":"src/components/makeComment","sourcesContent":["<template>\n  <div class=\"commentCard\">\n    <q-stepper\n      header-nav\n      class=\" \"\n      v-model=\"step\"\n      vertical\n      color=\"primary\"\n      animated\n    >\n      <!-- 课程选项 -->\n      <q-step\n        :name=\"0\"\n        :title=\"title[0]\"\n        icon=\"settings\"\n        \n        :done=\"step > 0\"\n      >\n        <q-item-label class=\"text-overline\">{{ content[0] }}</q-item-label>\n        <div class=\"q-gutter-sm\">\n          <q-item\n            v-for=\"(dimention, i) in dimentions\"\n            :key=\"i\"\n            tag=\"label\"\n            v-ripple\n          >\n            <q-item-section avatar>\n              <q-checkbox\n                v-model=\"selection\"\n                :val=\"dimention.apiName\"\n                color=\"primary\"\n              />\n            </q-item-section>\n            <q-item-section>\n              <q-item-label text-h6 text-weight-bold>{{\n                dimention.title\n              }}</q-item-label>\n              <q-item-label caption>{{ dimention.content }}</q-item-label>\n            </q-item-section>\n          </q-item>\n        </div>\n\n        <q-stepper-navigation class=\"q-gutter-sm\">\n          <q-item-label caption>如果没有上述情况可以直接点击继续</q-item-label>\n          <q-btn @click=\"step = 1\" color=\"primary\" label=\"继续进行下一步评价\" />\n        </q-stepper-navigation>\n      </q-step>\n\n      <!-- 课程内容 -->\n      <q-step\n        :name=\"1\"\n        :title=\"title[1]\"\n        icon=\"assignment\"\n        :done=\"comment[0] != ''\"\n      >\n        <q-item-label class=\"text-overline\">{{ content[1][0] }}</q-item-label>\n        <div>\n          <div class=\"q-pa-md\">\n            <div class=\"q-gutter-y-md column\">\n              <q-rating\n                v-model=\"score[0]\"\n                size=\"2.5em\"\n                :max=\"10\"\n                color=\"green-10\"\n                icon=\"star_border\"\n                icon-selected=\"star\"\n              />\n              <q-item-label class=\"text-body2 text-weight-bold\"\n                >当前评分{{ score[0] }}\n              </q-item-label>\n            </div>\n          </div>\n        </div>\n\n        <q-item-label class=\"q-py-sm text-overline\">{{\n          content[1][1]\n        }}</q-item-label>\n        <div class=\"q-gutter-sm\">\n          <q-editor\n            v-model=\"comment[0]\"\n            placeholder=\"请进一步解释说明\"\n            ref=\"editor\"\n            toolbar-text-color=\"white\"\n            toolbar-toggle-color=\"yellow-8\"\n            toolbar-bg=\"primary\"\n            :toolbar=\"[\n              ['bold', 'italic', 'underline'],\n              [\n                {\n                  label: $q.lang.editor.formatting,\n                  icon: $q.iconSet.editor.formatting,\n                  list: 'no-icons',\n                  options: ['p', 'h3', 'h4', 'h5', 'h6', 'code'],\n                },\n              ],\n            ]\"\n          >\n          </q-editor>\n        </div>\n\n        <q-stepper-navigation class=\"q-gutter-sm\">\n          <q-item-label caption>如果没有上述情况可以直接点击继续</q-item-label>\n          <q-btn @click=\"step = 2\" color=\"primary\" label=\"继续进行下一步评价\" />\n          <q-btn\n            flat\n            @click=\"step = 0\"\n            color=\"primary\"\n            label=\"返回上一步\"\n            class=\"q-ml-sm\"\n          />\n        </q-stepper-navigation>\n      </q-step>\n\n      <!-- 教学水平 -->\n      <q-step\n        :name=\"2\"\n        :title=\"title[2]\"\n        icon=\"assignment\"\n        :done=\"comment[1] != ''\"\n      >\n        <q-item-label class=\"text-overline\">{{ content[2][0] }}</q-item-label>\n        <div>\n          <div class=\"q-pa-md\">\n            <div class=\"q-gutter-y-md column\">\n              <q-rating\n                v-model=\"score[1]\"\n                size=\"2.5em\"\n                :max=\"10\"\n                color=\"green-10\"\n                icon=\"star_border\"\n                icon-selected=\"star\"\n              />\n              <q-item-label class=\"text-body2 text-weight-bold\"\n                >当前评分{{ score[1] }}\n              </q-item-label>\n            </div>\n          </div>\n        </div>\n\n        <q-item-label class=\"q-py-sm text-overline\">{{\n          content[2][1]\n        }}</q-item-label>\n        <div class=\"q-gutter-sm\">\n          <q-editor\n            v-model=\"comment[1]\"\n            placeholder=\"请进一步解释说明\"\n            ref=\"editor\"\n            toolbar-text-color=\"white\"\n            toolbar-toggle-color=\"yellow-8\"\n            toolbar-bg=\"primary\"\n            :toolbar=\"[\n              ['bold', 'italic', 'underline'],\n              [\n                {\n                  label: $q.lang.editor.formatting,\n                  icon: $q.iconSet.editor.formatting,\n                  list: 'no-icons',\n                  options: ['p', 'h3', 'h4', 'h5', 'h6', 'code'],\n                },\n              ],\n            ]\"\n          >\n          </q-editor>\n        </div>\n\n        <q-stepper-navigation class=\"q-gutter-sm\">\n          <q-item-label caption>如果没有上述情况可以直接点击继续</q-item-label>\n          <q-btn @click=\"step = 3\" color=\"primary\" label=\"继续进行下一步评价\" />\n          <q-btn\n            flat\n            @click=\"step = 1\"\n            color=\"primary\"\n            label=\"返回上一步\"\n            class=\"q-ml-sm\"\n          />\n        </q-stepper-navigation>\n      </q-step>\n\n      <!-- 评分情况 -->\n      <q-step\n        :name=\"3\"\n        :title=\"title[3]\"\n        icon=\"assignment\"\n        :done=\"comment[2] != ''\"\n      >\n        <q-item-label class=\"text-overline\">{{ content[3][0] }}</q-item-label>\n        <div>\n          <div class=\"q-pa-md\">\n            <div class=\"q-gutter-y-md column\">\n              <q-rating\n                v-model=\"score[2]\"\n                size=\"2.5em\"\n                :max=\"10\"\n                color=\"green-10\"\n                icon=\"star_border\"\n                icon-selected=\"star\"\n              />\n              <q-item-label class=\"text-body2 text-weight-bold\"\n                >当前评分{{ score[2] }}\n              </q-item-label>\n            </div>\n          </div>\n        </div>\n\n        <q-item-label class=\"q-py-sm text-overline\">{{\n          content[3][1]\n        }}</q-item-label>\n        <div class=\"q-gutter-sm\">\n          <q-editor\n            v-model=\"comment[2]\"\n            placeholder=\"请进一步解释说明\"\n            ref=\"editor\"\n            toolbar-text-color=\"white\"\n            toolbar-toggle-color=\"yellow-8\"\n            toolbar-bg=\"primary\"\n            :toolbar=\"[\n              ['bold', 'italic', 'underline'],\n              [\n                {\n                  label: $q.lang.editor.formatting,\n                  icon: $q.iconSet.editor.formatting,\n                  list: 'no-icons',\n                  options: ['p', 'h3', 'h4', 'h5', 'h6', 'code'],\n                },\n              ],\n            ]\"\n          >\n          </q-editor>\n        </div>\n\n        <q-stepper-navigation class=\"q-gutter-sm\">\n          <q-item-label caption>如果没有上述情况可以直接点击继续</q-item-label>\n          <q-btn @click=\"step = 4\" color=\"primary\" label=\"继续进行下一步评价\" />\n          <q-btn\n            flat\n            @click=\"step = 2\"\n            color=\"primary\"\n            label=\"返回上一步\"\n            class=\"q-ml-sm\"\n          />\n        </q-stepper-navigation>\n      </q-step>\n\n      <!-- 课程作业 -->\n      <q-step\n        :name=\"4\"\n        :title=\"title[4]\"\n        icon=\"assignment\"\n        :done=\"comment[3] != ''\"\n      >\n        <q-item-label class=\"text-overline\">{{ content[4][0] }}</q-item-label>\n        <div>\n          <div class=\"q-pa-md\">\n            <div class=\"q-gutter-y-md column\">\n              <q-rating\n                v-model=\"score[3]\"\n                size=\"2.5em\"\n                :max=\"10\"\n                color=\"green-10\"\n                icon=\"star_border\"\n                icon-selected=\"star\"\n              />\n              <q-item-label class=\"text-body2 text-weight-bold\"\n                >当前评分{{ score[3] }}\n              </q-item-label>\n            </div>\n          </div>\n        </div>\n\n        <q-item-label class=\"q-py-sm text-overline\">{{\n          content[4][1]\n        }}</q-item-label>\n        <div class=\"q-gutter-sm\">\n          <q-editor\n            v-model=\"comment[3]\"\n            placeholder=\"请进一步解释说明\"\n            ref=\"editor\"\n            toolbar-text-color=\"white\"\n            toolbar-toggle-color=\"yellow-8\"\n            toolbar-bg=\"primary\"\n            :toolbar=\"[\n              ['bold', 'italic', 'underline'],\n              [\n                {\n                  label: $q.lang.editor.formatting,\n                  icon: $q.iconSet.editor.formatting,\n                  list: 'no-icons',\n                  options: ['p', 'h3', 'h4', 'h5', 'h6', 'code'],\n                },\n              ],\n            ]\"\n          >\n          </q-editor>\n        </div>\n\n        <q-stepper-navigation class=\"q-gutter-sm\">\n          <q-item-label caption>如果没有上述情况可以直接点击继续</q-item-label>\n          <q-btn @click=\"step = 5\" color=\"primary\" label=\"继续进行下一步评价\" />\n          <q-btn\n            flat\n            @click=\"step = 3\"\n            color=\"primary\"\n            label=\"返回上一步\"\n            class=\"q-ml-sm\"\n          />\n        </q-stepper-navigation>\n      </q-step>\n\n      <!-- 预览 -->\n      <q-step :name=\"5\" :title=\"title[5]\" icon=\"assignment\">\n        <q-item-label v-if=\"isFinish\" class=\"text-overline q-pa-md\">{{\n          content[5][0]\n        }}</q-item-label>\n        <q-item-label v-else class=\"text-overline q-pa-md\">{{\n          content[5][1]\n        }}</q-item-label>\n\n        <course-comment\n          v-if=\"isFinish\"\n          :apiData=\"apiInterface\"\n          :taker=\"{\n            nickname: userInfo.nickname,\n            grade: userInfo.degree,\n            major: userInfo.majorid,\n          }\"\n          :needGetEva=\"false\"\n        />\n\n        <q-stepper-navigation class=\"q-gutter-sm\">\n          <div class=\"row flex-center\">\n            <q-btn\n              @click=\"handleSubmit()\"\n              :disable=\"!isFinish\"\n              color=\"primary\"\n              label=\"提交\"\n            />\n            <q-btn\n              flat\n              @click=\"step = 4\"\n              color=\"primary\"\n              label=\"返回上一步\"\n              class=\"q-ml-sm\"\n            />\n          </div>\n        </q-stepper-navigation>\n      </q-step>\n    </q-stepper>\n  </div>\n</template>\n\n<script>\nimport CourseComment from \"../courseInfo/CourseComment\";\nimport { makeComment } from \"../../services/commentService\";\nimport { mapState } from \"vuex\";\nexport default {\n  components: {\n    CourseComment,\n  },\n  props: {\n    courseInfo: {\n      type: Object,\n    },\n  },\n\n  computed: {\n    ...mapState(\"userInfo\", [\"userInfo\", \"token\"]),\n    isFinish() {\n      if (\n        this.comment[0] != \"\" &&\n        this.comment[1] != \"\" &&\n        this.comment[2] != \"\" &&\n        this.comment[3] != \"\"\n      ) {\n        return true;\n      }\n      return false;\n    },\n\n    apiInterface() {\n      return {\n        content: this.comment[0],\n        teaching: this.comment[1],\n        grade: this.comment[2],\n        homework: this.comment[3],\n\n        midterm: this.selection.includes(\"midterm\") ? 1 : 0,\n        final: this.selection.includes(\"final\") ? 1 : 0,\n        quiz: this.selection.includes(\"quiz\") ? 1 : 0,\n        assignment: this.selection.includes(\"assignment\") ? 1 : 0,\n        essay: this.selection.includes(\"essay\") ? 1 : 0,\n        project: this.selection.includes(\"project\") ? 1 : 0,\n        attendance: this.selection.includes(\"attendance\") ? 1 : 0,\n        reading: this.selection.includes(\"reading\") ? 1 : 0,\n        presentation: this.selection.includes(\"presentation\") ? 1 : 0,\n\n        overall: this.score[0],\n        instructor: this.score[1],\n        grading: this.score[2],\n        workload: this.score[3],\n\n        anomymous: 0,\n\n        userId: this.userInfo.userid,\n\n        usefulnum: 0,\n        uselessnum: 0,\n        date: Date(),\n\n        courseId: this.courseInfo.courseId,\n\n        teacherId: this.courseInfo.teacherId,\n      };\n    },\n  },\n  methods: {\n    async handleSubmit() {\n      // 加载效果\n      this.isLoading = true;\n      this.$q.loading.show();\n      // 设置定时器\n      setTimeout(() => {\n        if (this.isLoading) {\n          // 如果到了时间还没有加载成功\n          this.$q.notify({\n            message: \"请求超时，请重试\",\n            position: \"center\",\n            timeout: \"2000\",\n          });\n          this.$q.loading.hide();\n        }\n      }, 5000);\n\n      console.log(\"before commenting userInfo\", this.userInfo);\n\n      var resp = await makeComment({\n        token: this.token,\n        apiInterface: this.apiInterface,\n      });\n\n\n      console.log(\"after making comment \", resp);\n\n      if (resp.status) {\n        this.isLoading = false;\n        this.$q.loading.hide();\n        this.$q.notify({\n          message: \"评价成功\",\n          position: \"center\",\n          timeout: \"1000\",\n        });\n        this.$router.push({\n          name: \"courseInfo\",\n          params: {\n            courseId: this.courseInfo.courseId,\n          },\n        });\n      } else {\n        this.isLoading = false;\n        this.$q.loading.hide();\n        this.$q.notify({\n          message: \"评价失败，请稍后再试\",\n          position: \"center\",\n          timeout: \"1000\",\n        });\n      }\n    },\n  },\n  data() {\n    return {\n      isLoading: false,\n      step: 0,\n      score: [5, 5, 5, 5],\n      comment: [\"\", \"\", \"\", \"\"],\n      selection: [],\n      title: [\n        \"请选择本门课程的相应情况\",\n        \"课程内容评价\",\n        \"教学水平评价\",\n        \"评分情况评价\",\n        \"课程作业评价\",\n        \"评价预览\",\n      ],\n      content: [\n        \"请根据你在上一个学期的上课情况如实填写相应内容\",\n        [\n          \"请根据你的个人体验，对该门课程的实际教学内容进行评价（1教学内容没有什么用--10教学内容没对我很有帮助）\",\n          \"请进行进一步的解释说明\",\n        ],\n        [\n          \"请根据你的个人体验，对该门课程的任课老师的教学水平进行评价（1教学水平较差--10教学水平较好）\",\n          \"请进行进一步的解释说明\",\n        ],\n        [\n          \"请根据你的个人体验，对该门课程的期末评分情况进行评价（1评分较差--10评分较好）\",\n          \"请进行进一步的解释说明\",\n        ],\n        [\n          \"请根据你的个人体验，对该门课程的课程作业量进行评价（1作业量较多--10作业量比较少）\",\n          \"请进行进一步的解释说明\",\n        ],\n        [\"这将会是你的的评价发表在TJSPACE后的效果\", \"你还有未完成的内容！\"],\n      ],\n      dimentions: [\n        {\n          apiName: \"midterm\",\n          title: \"期中考试\",\n          content:\n            \"该门课程在期中需要参加相应的考试，包括学校统一组织以及老师自行组织的开卷或者闭卷考试\",\n        },\n        {\n          apiName: \"final\",\n          title: \"期末考试\",\n          content:\n            \"该门课程在期末需要参加相应的考试，包括学校统一组织以及老师自行组织的开卷或者闭卷考试\",\n        },\n        {\n          apiName: \"quiz\",\n          title: \"课堂小测\",\n          content: \"该门课程在学期过程中学要进行课堂测验\",\n        },\n        {\n          apiName: \"assignment\",\n          title: \"课程作业\",\n          content: \"该门课程在课后需要完成老师在课堂中布置的相应作业\",\n        },\n        {\n          apiName: \"essay\",\n          title: \"课程论文\",\n          content: \"该门课程需要完成相应的课程论文\",\n        },\n        {\n          apiName: \"project\",\n          title: \"课程项目\",\n          content:\n            \"该门课程需要完成课程项目，项目相对于作业以及论文而言更加复杂\",\n        },\n        {\n          apiName: \"attendance\",\n          title: \"课堂考勤\",\n          content: \"该门课程老师会在上课期间进行考勤\",\n        },\n        {\n          apiName: \"reading\",\n          title: \"阅读材料\",\n          content: \"该门课程除了相应的教材外还需要阅读相应的阅读材料\",\n        },\n        {\n          apiName: \"presentation\",\n          title: \"个人展示\",\n          content: \"该门课程需要进行个人展示\",\n        },\n      ],\n    };\n  },\n};\n</script>\n\n<style scoped>\n.commentCard {\n  max-width: 800px;\n}\n</style>"]}]}